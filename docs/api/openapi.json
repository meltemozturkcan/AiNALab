{"openapi":"3.1.0","info":{"title":"Child Voice Recorder API","version":"0.1.0"},"paths":{"/api/v1/health":{"get":{"tags":["health"],"summary":"Health Check","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/session-runtime":{"post":{"tags":["session-runtime"],"summary":"Create Session Runtime","operationId":"create_session_runtime_api_v1_session_runtime_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionRuntimeCreateRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionRuntimeCreateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/_schema-test/session":{"post":{"tags":["schema-test","schema-test"],"summary":"Schema Test Session","operationId":"schema_test_session_api_v1__schema_test_session_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSessionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/_schema-test/runtime":{"post":{"tags":["schema-test","schema-test"],"summary":"Schema Test Runtime","operationId":"schema_test_runtime_api_v1__schema_test_runtime_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionRuntimeCreateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recordings/upload-intent":{"post":{"tags":["recordings"],"summary":"Request Upload Intent","operationId":"request_upload_intent_api_v1_recordings_upload_intent_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordingUploadIntentRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordingUploadIntentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recordings/finalize":{"post":{"tags":["recordings"],"summary":"Finalize Upload","operationId":"finalize_upload_api_v1_recordings_finalize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordingFinalizeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordingFinalizeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recordings/failed":{"post":{"tags":["recordings"],"summary":"Mark Failed","operationId":"mark_failed_api_v1_recordings_failed_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordingMarkFailedRequest"}}},"required":true},"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ConsentArtifact":{"properties":{"consent_version":{"type":"string","maxLength":64,"minLength":1,"title":"Consent Version"},"consent_text_hash":{"type":"string","maxLength":128,"minLength":16,"title":"Consent Text Hash"},"consent_accepted_at":{"type":"string","format":"date-time","title":"Consent Accepted At","description":"UTC timestamp when consent accepted."},"jurisdiction":{"type":"string","enum":["TR","EU","OTHER"],"title":"Jurisdiction","default":"TR"}},"additionalProperties":false,"type":"object","required":["consent_version","consent_text_hash","consent_accepted_at"],"title":"ConsentArtifact","description":"PII i├ğermez.\nConsent'in kan─▒tlanabilir bir artifact olarak saklanmas─▒ hedeflenir."},"CreateSessionRequest":{"properties":{"consent":{"$ref":"#/components/schemas/ConsentArtifact"},"demography":{"$ref":"#/components/schemas/Demography"}},"additionalProperties":false,"type":"object","required":["consent","demography"],"title":"CreateSessionRequest"},"Demography":{"properties":{"birth_year":{"type":"integer","maximum":2100.0,"minimum":1900.0,"title":"Birth Year"},"birth_month":{"type":"integer","maximum":12.0,"minimum":1.0,"title":"Birth Month"},"gender":{"type":"string","enum":["female","male","other","unknown"],"title":"Gender","default":"unknown"}},"additionalProperties":false,"type":"object","required":["birth_year","birth_month"],"title":"Demography","description":"birth_month/year kal─▒c─▒d─▒r: sessions i├ğinde saklan─▒r, session_runtimeÔÇÖda ta┼ş─▒nmaz."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"RecordingFinalizeRequest":{"properties":{"recording_id":{"type":"string","minLength":6,"title":"Recording Id"}},"additionalProperties":false,"type":"object","required":["recording_id"],"title":"RecordingFinalizeRequest","description":"Client -> Backend: \"Upload bitti, art─▒k state'i ilerlet.\""},"RecordingFinalizeResponse":{"properties":{"recording_id":{"type":"string","title":"Recording Id"},"status":{"type":"string","title":"Status"},"ok_count":{"type":"integer","title":"Ok Count"},"completed":{"type":"boolean","title":"Completed"},"next_letter_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Next Letter Index"},"next_repeat_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Next Repeat Index"}},"additionalProperties":false,"type":"object","required":["recording_id","status","ok_count","completed","next_letter_index","next_repeat_index"],"title":"RecordingFinalizeResponse"},"RecordingMarkFailedRequest":{"properties":{"recording_id":{"type":"string","minLength":6,"title":"Recording Id"},"reason":{"anyOf":[{"type":"string","maxLength":256},{"type":"null"}],"title":"Reason"}},"additionalProperties":false,"type":"object","required":["recording_id"],"title":"RecordingMarkFailedRequest"},"RecordingUploadIntentRequest":{"properties":{"session_id":{"type":"string","minLength":8,"title":"Session Id"},"letter_index":{"type":"integer","maximum":28.0,"minimum":0.0,"title":"Letter Index"},"repeat_index":{"type":"integer","maximum":2.0,"minimum":1.0,"title":"Repeat Index"},"content_type":{"type":"string","enum":["audio/wav","audio/mpeg","audio/mp4","audio/webm","audio/ogg"],"title":"Content Type","default":"audio/wav"},"content_length":{"anyOf":[{"type":"integer","maximum":50000000.0,"minimum":1.0},{"type":"null"}],"title":"Content Length"}},"additionalProperties":false,"type":"object","required":["session_id","letter_index","repeat_index"],"title":"RecordingUploadIntentRequest","description":"Client -> Backend: \"Ben ┼şu harf/tekrar i├ğin upload yapaca─ş─▒m, bana SAS ver.\""},"RecordingUploadIntentResponse":{"properties":{"recording_id":{"type":"string","title":"Recording Id"},"session_id":{"type":"string","title":"Session Id"},"blob_path":{"type":"string","title":"Blob Path"},"upload_url":{"type":"string","title":"Upload Url"},"expires_at":{"type":"string","format":"date-time","title":"Expires At"}},"additionalProperties":false,"type":"object","required":["recording_id","session_id","blob_path","upload_url","expires_at"],"title":"RecordingUploadIntentResponse","description":"Backend -> Client: SAS URL + deterministic blob path + recording_id"},"SessionRuntimeCreateRequest":{"properties":{"session_id":{"type":"string","minLength":8,"title":"Session Id"},"ttl_seconds":{"anyOf":[{"type":"integer","maximum":86400.0,"minimum":60.0},{"type":"null"}],"title":"Ttl Seconds"}},"additionalProperties":false,"type":"object","required":["session_id"],"title":"SessionRuntimeCreateRequest"},"SessionRuntimeCreateResponse":{"properties":{"runtime_token":{"type":"string","title":"Runtime Token"},"session_id":{"type":"string","title":"Session Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"expires_at":{"type":"string","format":"date-time","title":"Expires At"},"progress":{"$ref":"#/components/schemas/SessionRuntimeProgress"}},"additionalProperties":false,"type":"object","required":["runtime_token","session_id","created_at","expires_at","progress"],"title":"SessionRuntimeCreateResponse"},"SessionRuntimeProgress":{"properties":{"completed_recordings":{"type":"integer","maximum":58.0,"minimum":0.0,"title":"Completed Recordings","default":0},"completed":{"type":"boolean","title":"Completed","default":false},"next_letter_index":{"type":"integer","maximum":28.0,"minimum":0.0,"title":"Next Letter Index","default":0},"next_repeat_index":{"type":"integer","maximum":2.0,"minimum":1.0,"title":"Next Repeat Index","default":1},"last_success_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Success At"}},"additionalProperties":false,"type":"object","title":"SessionRuntimeProgress"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
